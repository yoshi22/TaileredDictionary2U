# 01. Product Requirements Document (PRD)

## ターゲットユーザー

### プライマリターゲット
**20-40代の学習意欲が高い社会人**

| ペルソナ | 特徴 | 主な用途 |
|---------|------|----------|
| **エンジニア太郎** | 28歳、Web開発者 | 新技術の専門用語キャッチアップ |
| **転職花子** | 32歳、異業種転職 | 新業界の用語オンボーディング |
| **語学次郎** | 25歳、TOEIC勉強中 | 英単語の効率的暗記 |

### ユーザーニーズ
1. **時間効率**: 短時間で効果的に学習したい
2. **手軽さ**: 登録の手間を最小化したい
3. **継続性**: 忘れる前に復習したい
4. **理解度**: 単語だけでなく使い方も知りたい

---

## 主要ユースケース

### UC-1: 新しい用語を登録する
```
アクター: ユーザー
前提条件: ログイン済み
成功シナリオ:
1. ユーザーが「新規Entry」をクリック
2. Term（用語）を入力
3. （任意）Context（前後の文脈）を入力
4. （任意）Deckを選択
5. 「保存」をクリックしてEntryを作成
6. エントリー詳細画面で「AI生成」を押下
7. システムがEnrichmentを生成してEntryに保存
8. EntryのSRSデータが初期化され、復習キューに追加
```

### UC-2: 復習セッションを行う
```
アクター: ユーザー
前提条件: Due（復習期限）のEntryが存在
成功シナリオ:
1. ユーザーが「復習」をクリック
2. システムがDue Entryをカード形式で表示
3. ユーザーがカードをめくる（回答確認）
4. ユーザーが難易度を選択（Again/Hard/Good/Easy）
5. システムがSRSパラメータを更新
6. 次のカードを表示（または終了）
```

### UC-3: Deckを作成・管理する
```
アクター: ユーザー
成功シナリオ:
1. ユーザーが「Deck管理」を開く
2. 新規Deck名を入力して作成
3. Entry一覧からDeckを変更
4. Deckごとに復習を実行可能
```

### UC-4: Plus（有料プラン）にアップグレードする
```
アクター: 無料ユーザー
成功シナリオ:
1. AI生成上限に達し、アップグレード促進表示
2. ユーザーが「Plusにアップグレード」をクリック
3. Stripeチェックアウト画面へ遷移
4. 支払い完了
5. Entitlement更新、上限解除
```

### UC-5: クレジットを購入・消費する
```
アクター: Plusユーザー（上限超過時）
成功シナリオ:
1. Plus上限に達し、クレジット購入促進表示
2. ユーザーがクレジットパックを選択
3. Stripeチェックアウト完了
4. クレジット残高に加算
5. AI生成時にクレジットから消費
```

---

## 機能優先度 (MoSCoW)

### Must Have (MVP必須)

| 機能 | 説明 |
|------|------|
| **ユーザー認証** | Email/Password、Google OAuth |
| **Entry CRUD** | 作成・読取・更新・削除 |
| **AI Enrichment生成** | Term→日英訳+要約+例文+関連語+参考リンク |
| **SRS復習** | SM-2ベースの間隔反復 |
| **復習UI** | フラッシュカード形式 |
| **Deck管理** | フォルダ的グループ化 |
| **使用量制限** | Free/Plusの上限管理 |
| **Stripe決済** | サブスク+クレジット |
| **基本Dashboard** | Entry一覧、統計 |

### Should Have (MVP後すぐ)

| 機能 | 説明 |
|------|------|
| **検索・フィルタ** | Entry検索、Deck絞り込み |
| **統計ダッシュボード** | 学習進捗、復習グラフ |
| **Apple OAuth** | iOS展開に向けて |
| **Enrichment再生成** | 内容が不十分な場合 |
| **Entry編集** | 生成内容の手動修正 |
| **インポート/エクスポート** | CSV対応 |

### Could Have (将来)

| 機能 | 説明 |
|------|------|
| **テンプレートDeck** | 事前定義された単語集 |
| **リマインダー通知** | 復習時刻のプッシュ |
| **ダークモード** | UIテーマ切替 |
| **多言語対応** | 日英以外 |
| **OCR登録** | 画像から用語抽出 |
| **Share Sheet** | 他アプリからの共有 |

### Won't Have (対応しない)

| 機能 | 理由 |
|------|------|
| **共有Deck** | 個人向けに集中 |
| **リアルタイムコラボ** | 複雑度高 |
| **オフラインAI生成** | コスト・品質 |
| **音声読み上げ** | 優先度低 |

---

## 画面一覧（Web MVP）

| 画面 | パス | 説明 |
|------|------|------|
| ランディング | `/` | 未ログイン時のLP |
| ログイン | `/login` | サインイン |
| サインアップ | `/signup` | 新規登録 |
| ダッシュボード | `/dashboard` | Entry一覧、統計概要 |
| Entry詳細 | `/entry/[id]` | 単一Entry表示・編集 / AI生成・再生成 |
| 新規Entry | `/entry/new` | Term/Context入力 & 保存（AIは詳細画面で実行） |
| 復習 | `/review` | SRS復習セッション |
| Deck一覧 | `/decks` | Deck管理 |
| Deck詳細 | `/deck/[id]` | Deck内Entry一覧 |
| 設定 | `/settings` | プロフィール、プラン |
| 料金プラン | `/pricing` | プラン比較 |
| チェックアウト成功 | `/checkout/success` | 決済完了 |
| チェックアウトキャンセル | `/checkout/cancel` | 決済キャンセル |

---

## 非機能要件

### パフォーマンス
- ページ読み込み: < 3秒 (LCP)
- AI生成レスポンス: < 10秒
- 復習カード切替: < 500ms

### セキュリティ
- APIキーはサーバーサイドのみ
- RLS（Row Level Security）でデータ分離
- HTTPS必須
- XSS/CSRF対策

### スケーラビリティ
- 初期: 1000ユーザー対応
- 将来: 10万ユーザー対応設計

### 可用性
- MVP: 99.5% (Supabase/Vercel依存)
- 将来: 99.9%

---

## 制約事項

### 技術的制約
- LLMに送信するのは「term + context（前後1-2文）」まで
- 外部APIキーはサーバーサイドのみで管理
- Supabase Free tier の制限（500MB DB、2GB Storage）

### ビジネス制約
- 個人開発のため、複雑な機能は後回し
- 初期は広告なし、オーガニック獲得重視
- サポートは最小限（FAQ、GitHub Issues）

---

## 成功基準

### MVP成功の定義
1. **100人のアクティブユーザー**が週1回以上復習
2. **3人以上がPlusにアップグレード**（3% CVR検証）
3. **D7 Retention > 20%**

### 3ヶ月後の目標
1. 500 WAU
2. Plus会員 15人
3. MRR $100

---

## 関連ドキュメント

- [00_overview.md](./00_overview.md) - 概要
- [02_user_flows_web.md](./02_user_flows_web.md) - 画面フロー
- [07_srs_design.md](./07_srs_design.md) - SRSアルゴリズム
- [09_business_model_unit_economics.md](./09_business_model_unit_economics.md) - ビジネスモデル
